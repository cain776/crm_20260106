# 채널 케어 (Channel Care) 기획서

> 작성일: 2026-01-06  
> 버전: v0.2  
> 참고: 메디톡 플러스, 채팅 UI 레퍼런스

---

## 1. 개요

### 1.1 배경

- 환자들이 **카카오톡, 인스타그램, 네이버, 문자** 등 다양한 채널로 문의
- 채널별로 분산 관리 → **응대 누락, 중복 응대, 히스토리 관리 어려움**
- 경쟁사(메디톡 플러스)에서 SNS 통합 응대 기능 제공 중

### 1.2 목표

| 목표 | 설명 |
|------|------|
| **통합 인박스** | 모든 채널 메시지를 한 곳에서 확인 |
| **응대 효율화** | 담당자 배정, 응대 상태 관리 |
| **환자 연결** | 메시지 발신자와 기존 환자 정보 연동 |
| **히스토리 추적** | 채널별 대화 내역 통합 관리 |

---

## 2. 주요 기능

### 2.1 기능 구조 (Depth 3)

```
채널 케어 (Level 1)
│
├─ 통합 인박스 (Level 2)
│   ├─ 전체 메시지
│   ├─ 상태별 필터
│   │   ├─ 신규
│   │   ├─ 상담중
│   │   ├─ 보류
│   │   └─ 완료
│   ├─ 내 담당 메시지
│   └─ 미배정 메시지
│
├─ 채널 관리 (Level 2)
│   ├─ 카카오톡 연동
│   ├─ 인스타그램 연동
│   ├─ 네이버 톡톡 연동
│   ├─ 문자(SMS) 연동
│   └─ 이메일 연동
│
├─ 응대 설정 (Level 2)
│   ├─ 자동 응답 메시지
│   ├─ 업무 시간 설정
│   ├─ 담당자 자동 배정 규칙
│   └─ 응대 템플릿
│
└─ 통계 (Level 2)
    ├─ 채널별 문의량
    ├─ 응대 시간 분석
    └─ 담당자별 실적
```

---

### 2.2 기능별 상세

#### 📥 2.2.1 통합 인박스

| 기능 | 설명 |
|------|------|
| **실시간 알림** | 새 메시지 수신 시 데스크톱/모바일 푸시 알림 |
| **채널 아이콘 표시** | 각 메시지에 출처 채널 표시 (카톡/인스타/네이버 등) |
| **온라인 상태 표시** | 상담사 온라인/오프라인 상태 표시 |
| **상태 관리** | 신규 → 상담중 → 보류 → 완료 상태 변경 |
| **담당자 배정** | 메시지별 담당 직원 지정 |
| **환자 매칭** | 전화번호/이름 기반 기존 환자 자동 매칭 |
| **대화 병합** | 동일 환자의 여러 채널 대화 통합 보기 |
| **읽음 확인** | 메시지 읽음/미읽음 상태 표시 (✓✓) |
| **미읽음 뱃지** | 대화별 미읽음 메시지 개수 표시 |

##### 상태 정의

| 상태 | 설명 | 색상 |
|------|------|------|
| **신규** | 새로 인입된 메시지, 아직 응대 시작 전 | � 빨강 |
| **상담중** | 현재 상담사가 응대 진행 중 | 🟢 초록 |
| **보류** | 환자 답변 대기 또는 내부 확인 필요 | 🟡 노랑 |
| **완료** | 상담 종료 | ⚪ 회색 |

#### �🔗 2.2.2 채널 연동

| 채널 | 연동 방식 | 우선순위 |
|------|----------|---------|
| **카카오톡** | 카카오 비즈니스 API | 🔴 필수 |
| **인스타그램** | Meta Business API | 🟡 주요 |
| **네이버 톡톡** | 네이버 톡톡 API | 🟡 주요 |
| **문자(SMS)** | NHN Cloud / 알리고 | 🔴 필수 |
| **이메일** | SMTP/IMAP 연동 | 🟢 선택 |

#### ⚙️ 2.2.3 응대 설정

| 설정 | 설명 |
|------|------|
| **자동 응답** | 업무 외 시간/휴일 자동 안내 메시지 |
| **업무 시간** | 채널별 응대 가능 시간 설정 |
| **자동 배정** | 키워드/채널/시간 기반 담당자 자동 배정 |
| **템플릿** | 자주 쓰는 응답 저장 및 빠른 삽입 |

#### 📊 2.2.4 통계 대시보드

| 지표 | 설명 |
|------|------|
| **일/주/월 문의량** | 채널별 인입 건수 추이 |
| **평균 응대 시간** | 첫 응답까지 소요 시간 |
| **응대 완료율** | 전체 대비 완료 처리 비율 |
| **담당자별 처리량** | 직원별 응대 실적 |

---

## 3. 화면 구성 (와이어프레임)

### 3.0 UI 레퍼런스

![채팅 UI 레퍼런스](/Users/kimseungwook/.gemini/antigravity/brain/eac43039-3a81-40cb-b8c5-39c9cf59a108/uploaded_image_1767697968804.png)

**레퍼런스 분석:**

- 좌측: 대화 목록 (검색, 아바타, 이름, 시간, 미리보기, 미읽음 뱃지)
- 우측: 대화창 (온라인 상태, 화상통화 버튼, 메시지 버블, 이미지 첨부)
- 하단: 메시지 입력 (이모지, 첨부, 음성, 전송 버튼)

---

### 3.1 통합 인박스 화면 (3분할 레이아웃)

```
┌──────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  채널 케어 > 통합 인박스                                                                        [+ 새 메시지]    │
├──────────┬────────────────────────────────────────────────┬──────────────────────────────────────────────────────┤
│          │ 상태: [전체▼] [신규 3] [상담중 5] [보류 2]     │  김영희 [카톡]           🟢 Online    📞 📹 ⋯       │
│ 🔍 검색.. ├────────────────────────────────────────────────┤  상태: [상담중▼]                     담당: 상담팀▼  │
│          │                                                ├──────────────────────────────────────────────────────┤
│ ─────────│ ┌──────────────────────────────────────────┐   │                                                      │
│ 상태필터 │ │🔴 [카톡] 김영희      10분 전    신규 (3) │ ← │       ┌────────────────────────────┐                 │
│ ○ 전체   │ │ ✓ "수술 상담 예약하고 싶어요"           │   │       │ 안녕하세요, 수술 상담      │                 │
│ ○ 신규   │ └──────────────────────────────────────────┘   │       │ 예약하고 싶어요.  05:23 PM │                 │
│ ● 상담중 │ ┌──────────────────────────────────────────┐   │       └────────────────────────────┘                 │
│ ○ 보류   │ │🟢 [인스타] 이수진    40분 전   상담중   │   │                                                      │
│ ○ 완료   │ │ ✓✓ "가격 문의드려요"          [상담팀]  │   │  ┌──────────────────────────────┐                    │
│ ─────────│ └──────────────────────────────────────────┘   │  │ 안녕하세요! 비앤빛입니다 😊   │                    │
│ 채널필터 │ ┌──────────────────────────────────────────┐   │  │ 상담 예약 도와드릴게요.      │                    │
│ ☑ 카톡   │ │🟡 [네이버] 박철수    1시간 전   보류    │   │  │                     05:23 PM │ ✓✓                 │
│ ☑ 인스타 │ │ ✓✓ "검사결과 언제 나오나요?"           │   │  └──────────────────────────────┘                    │
│ ☑ 네이버 │ └──────────────────────────────────────────┘   │                                                      │
│ ☐ 문자   │ ┌──────────────────────────────────────────┐   │       ┌────────────────────────────┐                 │
│ ─────────│ │⚪ [문자] 최민수      어제       완료    │   │       │ 감사합니다! 언제가         │                 │
│ 담당자   │ │ ✓✓ "감사합니다"                        │   │       │ 편하실까요?       05:24 PM │                 │
│ ○ 전체   │ └──────────────────────────────────────────┘   │       └────────────────────────────┘                 │
│ ● 내담당 │                                                │                                                      │
│ ○ 미배정 │                                                ├──────────────────────────────────────────────────────┤
│          │                                                │ 📋 환자정보  이름: 김영희 | 연락처: 010-1234-5678   │
│          │                                                │ 최근방문: 12-20 | 담당의: 이OO [환자차트 열기]       │
├──────────┴────────────────────────────────────────────────┼──────────────────────────────────────────────────────┤
│                                                           │ [템플릿▼] 😊 📎  ┌────────────────────┐  [Send]      │
│                                                           │                  │ 메시지 입력...      │              │
│                                                           │                  └────────────────────┘              │
└───────────────────────────────────────────────────────────┴──────────────────────────────────────────────────────┘
```

**3분할 레이아웃 구성:**

| 영역 | 너비 | 내용 |
|------|------|------|
| **좌측 (필터)** | ~15% | 상태/채널/담당자 필터, 검색 |
| **중앙 (대화목록)** | ~35% | 대화 카드 리스트, 미리보기 |
| **우측 (대화상세)** | ~50% | 선택된 대화 내용, 환자정보, 메시지 입력 |

**UI 요소 설명:**

| 요소 | 설명 |
|------|------|
| 🔴🟢🟡⚪ | 상태별 색상 인디케이터 (신규/상담중/보류/완료) |
| ✓ / ✓✓ | 메시지 읽음 확인 (단일: 전송됨, 이중: 읽음) |
| (3) | 미읽음 메시지 수 뱃지 |
| ← | 현재 선택된 대화 표시 |
| [상담팀] | 배정된 담당자/팀 표시 |

### 3.2 대화 상세 화면

```
┌───────────────────────────────────────────────────────────────────────┐
│  ← 목록   김영희 [카카오톡]     🟢 Online      📞  📹  ⋯  담당:상담팀▼│
├───────────────────────────────────────────────────────────────────────┤
│  상태: [신규 ▼]  →  [상담중]  [보류]  [완료]                          │
├────────────────────────────────────────────────┬──────────────────────┤
│                대화 영역                        │   📋 환자 정보       │
│                                                │                      │
│      ┌─────────────────────────────────┐       │   이름: 김영희       │
│      │ 안녕하세요, 수술 상담 예약하고   │       │   연락처: 010-1234..│
│      │ 싶어요. 라식이랑 라섹 차이가     │       │   최근방문: 12-20   │
│      │ 궁금해요.               05:23 PM │       │   담당의: 이OO       │
│      └─────────────────────────────────┘       │                      │
│                                                │   [환자 차트 열기]   │
│  ┌─────────────────────────────────────┐       │   ─────────────      │
│  │ 안녕하세요! 비앤빛 안과입니다 😊     │       │   📎 첨부 이력       │
│  │ 상담 예약 도와드릴게요.      05:23 PM│✓✓     │   - 가격표.pdf       │
│  └─────────────────────────────────────┘       │   - 시술안내.jpg     │
│                                                │                      │
│  ┌─────────────────────────────────────┐       │   📝 메모            │
│  │ 감사합니다! 언제가 편하실까요?       │       │   라섹 관심,        │
│  │                             05:24 PM│✓      │   가격 문의 중       │
│  └─────────────────────────────────────┘       │                      │
│                                                │                      │
│      ┌─────────────────────────────────┐       │                      │
│      │ 내일 오후 2시 가능할까요?        │       │                      │
│      │ [이미지 2장]             05:25 PM│       │                      │
│      └─────────────────────────────────┘       │                      │
│                                             ✓✓ │                      │
├────────────────────────────────────────────────┴──────────────────────┤
│  [템플릿▼]  😊  📎  🎤   ┌─────────────────────────────┐  [Send]       │
│                         │ Enter message...            │               │
│                         └─────────────────────────────┘               │
└───────────────────────────────────────────────────────────────────────┘
```

**대화창 UI 요소:**

| 요소 | 설명 |
|------|------|
| 🟢 Online | 상담사 온라인 상태 표시 |
| 📞 📹 | 음성/화상 통화 버튼 (향후) |
| ⋯ | 더보기 메뉴 (대화 삭제, 내보내기 등) |
| 😊 | 이모지 선택기 |
| 📎 | 파일/이미지 첨부 |
| 🎤 | 음성 메시지 (향후) |
| ✓ / ✓✓ | 전송됨 / 읽음 확인 |
| 📋 환자 정보 | 우측 패널에 환자 정보 표시 |
| 📝 메모 | 상담사 내부 메모 기록 |

---

## 4. 데이터 모델

### 4.1 주요 테이블

```sql
-- 채널 연동 설정
CREATE TABLE channel_integration (
    id SERIAL PRIMARY KEY,
    channel_type VARCHAR(20),      -- kakao, instagram, naver, sms, email
    access_token TEXT,
    refresh_token TEXT,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- 대화 스레드
CREATE TABLE conversation (
    id SERIAL PRIMARY KEY,
    channel_type VARCHAR(20),
    external_id VARCHAR(100),       -- 외부 채널의 대화 ID
    patient_id INTEGER REFERENCES patient(id),
    assigned_staff_id INTEGER REFERENCES staff(id),
    status VARCHAR(20),             -- new, consulting, pending, completed (신규/상담중/보류/완료)
    last_message_at TIMESTAMP,
    created_at TIMESTAMP
);

-- 메시지
CREATE TABLE message (
    id SERIAL PRIMARY KEY,
    conversation_id INTEGER REFERENCES conversation(id),
    direction VARCHAR(10),          -- inbound, outbound
    content TEXT,
    sender_name VARCHAR(100),
    sender_contact VARCHAR(50),
    sent_at TIMESTAMP,
    created_at TIMESTAMP
);

-- 응답 템플릿
CREATE TABLE response_template (
    id SERIAL PRIMARY KEY,
    title VARCHAR(100),
    content TEXT,
    category VARCHAR(50),
    usage_count INTEGER DEFAULT 0,
    created_at TIMESTAMP
);
```

---

## 5. 개발 범위 및 우선순위

### 5.1 1차 오픈 (MVP)

| 기능 | 포함 여부 |
|------|----------|
| 통합 인박스 UI | ✅ |
| 카카오톡 연동 | ✅ |
| 문자(SMS) 연동 | ✅ |
| 담당자 수동 배정 | ✅ |
| 상태 관리 | ✅ |
| 환자 정보 연동 | ✅ |
| 응답 템플릿 | ✅ |

### 5.2 2차 오픈

| 기능 | 포함 여부 |
|------|----------|
| 인스타그램 연동 | 📌 |
| 네이버 톡톡 연동 | 📌 |
| 자동 배정 규칙 | 📌 |
| 자동 응답 메시지 | 📌 |
| 통계 대시보드 | 📌 |

### 5.3 향후 고려

| 기능 | 비고 |
|------|------|
| 이메일 연동 | 수요 확인 후 |
| AI 자동 응답 | ChatGPT 연동 |
| 챗봇 시나리오 | 자동 응대 플로우 |

---

## 6. 기술 고려사항

### 6.1 외부 API 연동

| 채널 | API | 비용 |
|------|-----|------|
| 카카오톡 | 카카오 비즈메시지 API | 발송 건당 과금 |
| 인스타그램 | Meta Graph API | 무료 (앱 승인 필요) |
| 네이버 | 네이버 톡톡 API | 무료 |
| SMS | NHN Cloud / 알리고 | 건당 과금 |

### 6.2 실시간 처리

- **WebSocket** 또는 **Server-Sent Events** 활용
- 새 메시지 수신 시 실시간 UI 업데이트
- 푸시 알림 연동 (Firebase Cloud Messaging)

---

## 7. 경쟁사 비교

| 기능 | 메디톡 플러스 | EyeChartPro (제안) |
|------|--------------|-------------------|
| 카카오톡 연동 | ✅ | ✅ |
| 인스타그램 연동 | ✅ | ✅ (2차) |
| 환자 정보 연동 | ✅ | ✅ + 수술 이력 표시 |
| 통계 | 기본 | 상세 분석 |
| **안과 특화** | ❌ | ✅ 검사/수술 예약 연결 |

---

## 8. 리스크 및 대응

| 리스크 | 영향 | 대응 방안 |
|--------|------|----------|
| API 연동 지연 | 개발 일정 | 연동 완료 채널부터 순차 오픈 |
| 메시지 누락 | 고객 불만 | 폴링 + 웹훅 이중화 |
| 개인정보 이슈 | 법적 리스크 | 동의 절차 추가, 암호화 저장 |

---

## 9. 일정 (예상)

| 단계 | 기간 | 산출물 |
|------|------|--------|
| 기획 확정 | 1주 | 최종 기획서 |
| UI/UX 설계 | 2주 | 화면 설계서, 프로토타입 |
| API 연동 개발 | 3주 | 카카오/SMS 연동 |
| 프론트엔드 개발 | 3주 | 인박스 UI |
| 백엔드 개발 | 3주 | API 서버 |
| 테스트 | 2주 | QA 완료 |
| **총 기간** | **약 10~12주** | |

---

## 10. 검토 요청 사항

> [!IMPORTANT]
> 다음 사항에 대해 의사결정이 필요합니다:

1. **MVP 채널 범위**: 카카오톡 + SMS로 시작할지, 다른 채널 추가할지?
2. **비용 부담**: 메시지 발송 비용을 병원에서 부담하는 구조?
3. **환자 동의**: 채널 연동 시 환자 개인정보 동의 프로세스?
4. **2차 오픈 우선순위**: 인스타 vs 네이버 중 우선 연동 채널?

---

*본 문서는 초안으로, 검토 후 수정될 수 있습니다.*
